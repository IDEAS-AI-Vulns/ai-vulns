<c-row class="d-flex align-items-stretch">
    <c-col xs="12">
        <c-card>

            <c-card-header>
                <h5 class="mb-0 text-center"><strong>Scan Statistics</strong></h5>
            </c-card-header>

            <c-card-body>
                <!-- Spinner -->
                <div
                        *ngIf="scanInfoLoading"
                        class="d-flex justify-content-center align-items-center"
                        style="height: 200px;"
                >
                    <c-spinner color="primary"></c-spinner>
                </div>

                <!-- Content displays when data is loaded -->
                <div *ngIf="!scanInfoLoading">

                    <!-- ngx-datatable -->
                    <ngx-datatable
                            class="bootstrap"
                            [rows]="allScanInfos"
                            [columnMode]="'force'"
                            [footerHeight]="50"
                            [headerHeight]="50"
                            [rowHeight]="'auto'"
                            [limit]="scanInfoLimit"
                            [sorts]="[{prop: 'insertedDate', dir: 'desc'}]">

                        <!-- Date Column -->
                        <ngx-datatable-column name="Scan Date" prop="insertedDate">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                {{ row.insertedDate | date:'medium' }}
                            </ng-template>
                        </ngx-datatable-column>

                        <!-- Cloud Subscription/CodeRepo Column -->
                        <ngx-datatable-column name="Cloud Subscription/Repository" prop="target">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                {{ row.target}}
                            </ng-template>
                        </ngx-datatable-column>

                        <!-- Results Column -->
                        <ngx-datatable-column name="Results">
                            <ng-template let-row="row" ngx-datatable-cell-template>
                                <div class="d-flex flex-column">
                                    <div class="result-category d-flex align-items-center">
                                        <span class="category-label me-4">SCA</span>
                                        <div class="category-badges">
                                            <c-badge color="danger" class="result-badge" *ngIf="row.sastCritical > 0">{{ row.scaCritical }}</c-badge>
                                            <c-badge color="warning" class="result-badge" *ngIf="row.sastHigh > 0">{{ row.scaHigh }}</c-badge>
                                        </div>
                                    </div>


                                    <div class="result-category d-flex align-items-center">
                                        <span class="category-label me-4">SCA</span>
                                        <div class="category-badges">
                                            <c-badge color="danger" class="result-badge" *ngIf="row.scaCritical > 0">{{ row.scaCritical }}</c-badge>
                                            <c-badge color="warning" class="result-badge" *ngIf="row.scaHigh > 0">{{ row.scaHigh }}</c-badge>
                                        </div>
                                    </div>

                                    <div class="result-category d-flex align-items-center">
                                        <span class="category-label me-4">IaC</span>
                                        <div class="category-badges">
                                            <c-badge color="danger" class="result-badge" *ngIf="row.iacCritical > 0">{{ row.iacCritical }}</c-badge>
                                            <c-badge color="warning" class="result-badge" *ngIf="row.iacHigh > 0">{{ row.iacHigh }}</c-badge>
                                        </div>
                                    </div>

                                    <div class="result-category d-flex align-items-center">
                                        <span class="category-label me-4">Secrets</span>
                                        <div class="category-badges">
                                            <c-badge color="danger" class="result-badge" *ngIf="row.secretsCritical > 0">{{ row.secretsCritical }}</c-badge>
                                            <c-badge color="warning" class="result-badge" *ngIf="row.secretsHigh > 0">{{ row.secretsHigh }}</c-badge>
                                        </div>
                                    </div>

                                    <div class="result-category d-flex align-items-center">
                                        <span class="category-label me-4">GitLab Scan</span>
                                        <div class="category-badges">
                                            <c-badge color="danger" class="result-badge" *ngIf="row.gitlabCritical > 0">{{ row.gitlabCritical }}</c-badge>
                                            <c-badge color="warning" class="result-badge" *ngIf="row.gitlabHigh > 0">{{ row.gitlabHigh }}</c-badge>
                                        </div>
                                    </div>

                                    <div class="result-category d-flex align-items-center">
                                        <span class="category-label me-4">Cloud Scan</span>
                                        <div class="category-badges">
                                            <c-badge color="danger" class="result-badge" *ngIf="row.criticalFindings > 0">{{ row.criticalFindings }}</c-badge>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                        </ngx-datatable-column>

                    </ngx-datatable>
                </div>
            </c-card-body>
        </c-card>
    </c-col>
</c-row>